\section{Directed Acyclic Graphs}

\begin{definition}[DAG]
A directed graph $G = (V, E)$ is \emph{acyclic} if and only if $G$ does not contain cycles.
\end{definition}

\begin{definition}[Linearization / Topological Sorting]
Let $G = (V,E)$ be a directed graph. Let $X$ be an ordering of $V$.
If $X$ satisfies: if $(v_i, v_j)\in E$, then $v_i$ is before $v_j$ in $X$,
then we say $X$ is a linearization~(or toplogical sorting) of $G$.
\end{definition}


See some examples below.

\begin{figure}[h!]
\centering{\input{linearization}}
\caption{Examples of linearization.}
\end{figure}

If a directed graph $G$ admits a linearization, then we say $G$ can be \emph{linearized}.
We now show that linearization is an \emph{equivalent} characterization of DAGs.

\begin{claim}
A directed graph $G$ can be linearized if and only if $G$ is a DAG.
\label{claim:dag}
\end{claim}

\emph{Proof.}  Let's first prove that if $G$ can be linearized, then $G$ is a DAG.
This is equivalent to proving its contraposition: if $G$ contains a cycle, then $G$ cannot be linearized.
Suppose that there exists an cycle $v_{i_1} \to v_{i_2} \to \cdots \to v_{i_k} \to v_{i_1}$ in $G$.
Then the linearization $X$ must satisfy that $v_{i_{j}}$ is before $v_{i_{j+1}}$ for all $j = 1, 2, \cdots, k-1$,
and that $v_{i_{k}}$ is before $v_{i_1}$, in $X$. Clearly, this is not possible.

The other side of the statement, i.e., if $G$ is a DAG, then $G$ can always be linearized, can be proved constructively.
We will design an algorithm~(see below), that constructs a linearization for any DAG. \qed


Let $G = (V, E)$ be a directed graph. 
If a vertex $v\in V$ does not have any in-edges~(i.e., \emph{in-degree} is 0), we call it \emph{source vertex};
if a vertex $v\in V$ does not have any out-edges~(i.e., \emph{out-degree} is 0), we call it \emph{sink vertex}.

A directed graph may contain multiple source vertices or sink vertices,
or may not have any source vertex or sink vertex. (Can you give such examples?)

\begin{claim}
A DAG $G=(V,E)$ always has source vertex and sink vertex.
\end{claim}
\emph{Proof.} Let's prove it by contradiction. Assume that $G$ does not contain any source.
First, $G$ must not contain self-loop as otherwise $G$ won't be a DAG.
Let $v$ be any vertex in $V$. As $v$ is not a source, we know that there exists some vertex $u$ points to $v$, i.e., $(u,v)\in E$.
Now since $u$ is not a source then there must exist another vertex $w$ such that $(w,u)\in E$.
Notice that $w \neq v$ as otherwise there will be a cycle: $v = w \to u \to v$.
This means that $w$ is a new vertex. Again as $w$ is not a source, there must exist another \emph{new} vertex points to it.
This process can be extended infinitely following the fact and assumption that $G$ is a DAG and all vertices not are sources,
but this is not possible as the number of vertices is limited. 
The existence of sink can be proved symmetrically. \qed


Following above fact, we can design an algorithm to find a linearization of a DAG: it iteratively
finds source vertex and removes it and its adjacent edges.

\begin{minipage}{0.8\textwidth}
	\aaA {7}{Algorithm find-linearization ($G = (V, E)$)}\xxx
	\aab {init $X$ as empty list;}\xxx
	\aaB {4}{while ($|X| < |V|$)}\xxx
	\aac {arbitrarily find a source vertex $u$ of $G$;}\xxx
	\aac {add $u$ to the end of $X$;}\xxx
	\aac {remove $u$ and its adjacent edges;}\xxx
	\aab {end while;}\xxx
	\aaa {end algorithm;}\xxx
\end{minipage}

This algorithm is correct. First, when a vertex $u$ is added to $X$,
it is a source vertex of the current graph, which means that
$\{w\mid (w, u)\in E\}$ is either empty or all of them
have been added to $X$. Second, $X$ will include all vertices.
This is because, a source always exists in a DAG~(as we just proved).
The above algorithm is more a framework, as how we update the graph
is not given specifically, and which affects the running time.

Above algorithm also gives a constructive proof that, a DAG can always
be linearized. This completes the proof stated in previous lecture: a directed graph is a DAG if and only if it can be linearized.

\begin{claim}
Let $X$ be any linearization of a DAG. Then the first vertex of $X$ is a source vertex and 
the last vertex of of $X$ is a sink vertex.
\label{claim:source}
\end{claim}

\emph{Proof.} Let $v_1$ be the first vertex of $X$. Suppose that $v_1$ is not a source of $X$. 
By definition of (not being a) source vertex, there exists $(u,v_1)\in E$. Then by the definition
of linearization, we know that $u$ will be before $v_1$ in $X$, contradicting to the fact that
$v_1$ is the first element of $X$.
The other side can be proved symmetrically. \qed

We can use above algorithm to constructively prove following statement.

\begin{claim}
Let $G = (V, E)$ be a DAG. A vertex $u\in V$ is a source if and only if 
there exists a linearization $X$ of $G$ such that $u$ is the first vertex in $X$.
\end{claim}

\emph{Proof.} We first prove that, if $u$ is a source, then there exists a linearization
where $u$ is the first vertex of $X$. We prove it by showing that,
we can construct such a linearization $X$. We can use above algorithm,
and in its first step, we simply pick $u$. The correctness of above algorithm
explains the rest.  The other side is exactly Claim~\ref{claim:source}, which we have proved. \qed

\subsection*{Connectivity of Directed Graphs}

